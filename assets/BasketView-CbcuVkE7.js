import{_ as P,s as q,r as $,A as T,x as j,t as v,g as I,o as u,c as d,a as t,b as r,i as A,e as g,n as N,f as D,d as x,h as L,I as O,N as V,F as b,j as B,H as F,k as H,l as C}from"./index-BaWbFXvs.js";import{u as S,_ as z}from"./CardStore-DB_WCFHW.js";import{u as k,l as E}from"./lodash-DJeCCvsz.js";import{u as R}from"./OrdersStore-BpeqQHME.js";import"./_commonjsHelpers-Cpj98o6Y.js";const U="data:image/svg+xml,%3csvg%20width='17'%20height='16'%20viewBox='0%200%2017%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='17'%20height='15.0385'%20rx='1.3077'%20fill='%2328ADE1'/%3e%3crect%20x='3.9231'%20y='6.53845'%20width='9.15385'%20height='1.96154'%20rx='0.980769'%20fill='white'/%3e%3c/svg%3e",M="data:image/svg+xml,%3csvg%20width='17'%20height='16'%20viewBox='0%200%2017%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='17'%20height='15.04'%20rx='2'%20fill='%2328ADE1'/%3e%3crect%20x='3.9231'%20y='6.53912'%20width='9.15385'%20height='1.96174'%20rx='0.98087'%20fill='white'/%3e%3crect%20x='9.48077'%20y='2.94261'%20width='9.15478'%20height='1.96154'%20rx='0.980769'%20transform='rotate(90%209.48077%202.94261)'%20fill='white'/%3e%3c/svg%3e",Q=["id"],W=["src"],Y={class:"info mt-6 flex justify-between tracking-wide"},G={class:"text-green-600 pl-2"},J={class:"info mt-2.5 flex justify-between tracking-wide leading-none"},K={class:"text-green-600 pl-2"},X={class:"product-text"},Z={class:"flex justify-between"},tt={class:"flex gap-2.5"},et={class:"product-number"},st={__name:"BasketCard",props:{product:{type:Object,required:!0},groupCount:{type:Number,required:!0},group:{type:Object,required:!0}},setup(c){const{removeFromBasket:p,updateQuantity:h,getProducts:_}=k(),{getCards:y}=S(),{cards:f}=q(S()),o=c,l=$(o.groupCount);T(()=>o.groupCount,a=>{l.value=a});const w=j(()=>f.value.find(a=>a.id===o.product.product_id)),n=async a=>{const e=document.getElementById(`product-${a}`);e&&(e.style.transition="opacity 0.5s",e.style.opacity=0),setTimeout(()=>{o.group.products.forEach(m=>p(m.id)),v("Товар удален из корзины!","success")},500)},s=E.debounce(async()=>{l.value++,v("Количество товара увеличено!","info"),await h(o.product.product_id,1)},300),i=E.debounce(async()=>{l.value>1?(l.value--,v("Количество товара убавлено!","info"),await h(o.product.id,-1)):v("Минимальное количество товара — 1!","warning")},200);return I(async()=>{await y()}),(a,e)=>w.value?(u(),d("article",{key:0,id:`product-${c.product.id}`,class:"product"},[t("img",{class:"product-img h-48 -z-10 mt-2",src:r(A)(w.value),alt:"Product Image"},null,8,W),t("div",Y,[t("p",null,g(c.product.name),1),t("span",G,"₽"+g(c.product.price),1)]),t("div",{class:"buy-section",style:N({height:r(D)(o.product)})},[t("div",null,[t("div",J,[t("p",null,g(c.product.name),1),t("span",K,"₽"+g(c.product.price),1)]),t("p",X,g(c.product.description),1)]),t("div",Z,[t("div",tt,[t("button",{onClick:e[0]||(e[0]=(...m)=>r(i)&&r(i)(...m))},e[3]||(e[3]=[t("img",{class:"product-counting h-5",alt:"minus",src:U},null,-1)])),t("span",et,g(l.value),1),t("button",{onClick:e[1]||(e[1]=(...m)=>r(s)&&r(s)(...m))},e[4]||(e[4]=[t("img",{class:"product-counting h-5",alt:"plus",src:M},null,-1)]))]),t("button",{class:"product-button",onClick:e[2]||(e[2]=m=>n(o.product.id).then(()=>r(_)()))}," удалить ")])],4)],8,Q)):x("",!0)}},ot=P(st,[["__scopeId","data-v-e4a6e1dc"]]),rt={class:"catalog"},nt={class:"catalog-section"},ct={key:0,class:"m-auto mt-48 text-blue-600 text-3xl"},it={class:"flex w-full gap-y-5 justify-around flex-wrap"},at={__name:"BasketView",setup(c){const p=k(),{getProducts:h}=k(),{addToOrders:_}=R(),y=F(),f=$(!1),o=()=>{f.value=window.scrollY>window.innerHeight*.3},l=async()=>{document.querySelectorAll(".basket-item").forEach(s=>{s.classList.add("fade-out")}),setTimeout(()=>{_(),p.basketProducts=[],y.push("/orders")},500)},w=j(()=>p.basketProducts.reduce((n,s)=>(n[s.product_id]||(n[s.product_id]={products:[],count:0}),n[s.product_id].products.push(s),n[s.product_id].count+=s.quantity,n),{}));return I(async()=>{await h(),window.addEventListener("scroll",o)}),L(()=>{window.removeEventListener("scroll",o)}),(n,s)=>(u(),d("div",null,[t("div",rt,[O(t("button",{class:"catalog-button",onClick:l}," оформить ",512),[[V,r(p).basketProducts.length>0]])]),t("section",nt,[r(p).basketProducts.length===0?(u(),d("h1",ct," Корзина пуста ")):x("",!0),(u(!0),d(b,null,B(w.value,(i,a)=>(u(),d("div",{key:a,class:"flex gap-10 flex-wrap"},[t("div",it,[(u(!0),d(b,null,B(i.products.slice(0,1),e=>(u(),H(ot,{"group-count":i.count,class:"basket-item",group:i,product:e},null,8,["group-count","group","product"]))),256))])]))),128))]),f.value?(u(),d("img",{key:0,class:"scroll-up",src:z,alt:"arrow-up",onClick:s[0]||(s[0]=(...i)=>r(C)&&r(C)(...i))})):x("",!0)]))}},gt=P(at,[["__scopeId","data-v-29c3706f"]]);export{gt as default};
